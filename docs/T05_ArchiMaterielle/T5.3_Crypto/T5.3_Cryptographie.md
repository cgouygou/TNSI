# T5.3 Cryptographie

{{ initexo(0) }}


![](../images/meme_crypto.jpeg){: .center width=480} 


## 1. Chiffrement symétrique

!!! history "Brève historique de la cryptographie"
    La *cryptographie* est la discipline qui consiste à chiffrer et déchiffrer des messages afin de les protéger en les rendant secrets. La *cryptanalyse* est la discpline qui analyse les messages chiffrés (appelés aussi *cryptogrammes*) afin de les déchiffrer.

    ![](../images/scytale.png){: .center width=320} 

    On trouve des utilisations de cryptographie depuis l'antiquité, comme par exemple l'utilisation d'une [scytale](https://fr.wikipedia.org/wiki/Scytale){:target="_blank"} ou encore le célèbre  [chiffre de César](https://fr.wikipedia.org/wiki/Chiffrement_par_d%C3%A9calage){:target="_blank"} vu en classe de première qui consiste à effectuer un décalage des lettres du message, d'un nombre de lettres fixé à l'avance qui constitue la **clé** du système.

    Bien d'autres procédés ont été inventés par la suite (lire à ce sujet l'excellent *Histoire des codes secrets*, de Simon Singh, Le Livre de Poche, disponible à la médiathèque du lycée) à des fins bien souvent militaires qui nécessitaient une grande confidentialité...

    ![](../images/hcs_simonsingh.jpg){: .center width=160} 

    En 1586 [Blaise de Vigènere](https://fr.wikipedia.org/wiki/Chiffre_de_Vigen%C3%A8re){:target="_blank"}  met au pont un chiffrement *polyalphabétique* qui résistera près de 3 siècles. Le principe est de choisir une clé (par exemple NSI) et d'utiliser successivement un chiffre de César avec N pour la première lettre, puis un chiffre de César avec S pour la deuxième lettre, puis avec I pour la troisième, puis avec N pour la quatrième, puis avec S pour la cinquième, etc.

    Au XX-ème siècle, l'avènement de l'ordinateur et de sa puissance de calcul a motivé de nombreuses recherches et découvertes dans le domaine de la cryptographie pour réussir à sécuriser non seulement les secrets militaires, mais également les transactions bancaires et plus généralement l'échange de nos données personnelles sur le web...


!!! abstract "Principe d'un chiffrement"
    Un **chiffrement** est la transformation - à l'aide d'un algorithme - d'un texte clair en un texte incompréhensible, dit *chiffré*, à l'aide d'une **clé** de chiffrement.

    ![](../images/algo_crypto.png){: .center width=640} 

    L'algorithme est la plupart du temps connu, et la sécurité du chiffrement doit résider dans le secret de la clé ( [Principe de Kerckhoffs](https://fr.wikipedia.org/wiki/Principe_de_Kerckhoffs){:target="_blank"}).

    Cette clé peut être la même pour chiffrer et déchiffrer: on parle alors de **chiffrement  symétrique**. Si la clé de chiffrement et la clé de déchiffrement sont différentes, on parle de **chiffrement asymétrique**.

    En pratique la clé est un nombre ou une fonction mathématique. Mais c'est parfois un texte ou une image...


!!! example "{{ exercice() }}: chiffre de César"
    === "Énoncé" 
        1. Combien de clés différentes existe-t-il pour le chiffre de César?
        2. Compléter le code suivant (utiliser les fonctions `#!py ord` et `#!py chr` pour la fonction `#!py decale` :

            ```python linenums='1'
            def decale(lettre:str, cle:int) -> str:
                '''
                Décale une lettre majuscule de cle rangs dans l'alphabet.
                '''
                rang = ...(lettre) - ...(...)
                rang = (rang + ...) % ...
                return ...(rang)


            def chiffre_cesar(phrase:str, cle:int) -> str:
                '''
                Chiffre le texte phrase avec la clé cle et renvoie le texte chiffré
                '''
                texte_chiffre = ""
                for ... in ...:
                    texte_chiffre += ...
                return texte_chiffre

            ```
      
        3. Déchiffrer le message suivant:

            `#!py 'PRZRFFNTRARPBAGVRAGEVRAQVAGRERFFNAGZNVFVYRFGFHSSVFNZRAGYBATCBHEDHRPRFBVGCRAVOYRQRYRQRPUVSSERENYNZNVA'` 

    === "Correction" 
        {{ correction(False, 
        "
        "
        ) }}


!!! example "{{ exercice() }}: masque jetable ou chiffre de Vernam"
    === "Énoncé" 
        Dans le [DL 0001](https://cgouygou.github.io/TNSI/T07_Evaluations/Devoirs_Libres/DL1/){:target="_blank"}, on a vu le principe du chiffre de Vernam, plus communément appelé masque jetable.

        On y avait établi les fonctions:

        ```python linenums='1'
        def xor(a:str, b:str) -> str:
            '''
            revoie le résultat d'un XOR (ou exclusif) entre les caractères
            a et b, après conversion en code Unicode
            '''
            return chr(ord(a) ^ ord(b))

        def masque_jetable(chaine:str, cle:str) -> str:
            '''
            Chiffre la chaine de caractère chaine selon le chiffre de
            Vernam avec la clé cle.
            '''
            texte_chiffre = ''
            for k in range(len(chaine)):
                texte_chiffre += xor(chaine[k], cle[k%len(cle)])
            return texte_chiffre
        ```

        Déchiffrer le message : `#!py "\x0c!(8<en\x12%/=i\x1a&;'=.n ,<2 :s/'6;n7,n%&; h"` sachant que la clé comporte trois lettres majuscules et que c'est moi qui l'ai choisie...
        
    === "Correction" 
        {{ correction(False, 
        "
        "
        ) }}

Dans le cas du masque jetable, si la clé (le masque) est aussi longue que le texte clair, alors il est **impossible** de retrouver le texte initial! En revanche, il faut impérativement changer le masque à chaque utilisation (d'où le terme jetable).



!!! info "Avantage et inconvénient d'un chiffrement symétrique"
    - **Avantage**: Les chiffrements symétriques sont souvent rapides, consommant peu de ressources et donc adaptés au chiffrement de flux important d'informations.

        Comme nous le verrons, la sécurisation des données transitant par le protocole https est basée sur un chiffrement symétrique.

    - **Inconvénient**: La clé ! Si deux personnes (Alice et Bob dans la suite du cours) ont besoin d'utiliser un chiffrement pour se parler, comment peuvent-ils échanger leurs clés puisque leur canal de transmission n'est pas sûr ?

        Le chiffrement symétrique impose qu'Alice et Bob aient pu se rencontrer physiquement au préalable pour convenir d'une clé secrète, ou bien qu'ils aient réussi à établir une connexion sécurisée pour s'échanger cette clé.


## 2. Chiffrement asymétrique

### 2.1 Principe

### 2.2 Échange de clés

### 2.3 Authentification

## 3. Chiffrement RSA

## 4. HTTPS


## 5. Exercices

!!! example "{{ exercice() }}: Chiffrement affine"
    === "Énoncé" 
        !!! info "Principe"
            - Chaque lettre est codée par son rang dans l'alphabet: A → 0, B → 1, etc.
            - On applique à chaque rang la transformation affine $f(x)=(ax+b)\%26$ où $a$ et $b$ sont deux nombres entiers, **premiers entres eux** (c'est-à-dire n'admettant pas de diviseur commun autre que 1).
        
        1. Écrire une fonction `#!py affine`.
        2. Décoder la phrase `#!py UCGXLODCMOXPMFMSRJCFQOGTCRSUSXC`, sachant qu'elle contient le mot `TRAVAIL` et que $a$ et $b$ sont inférieurs à 20.
    === "Correction" 
        {{ correction(False, 
        "
        "
        ) }}
