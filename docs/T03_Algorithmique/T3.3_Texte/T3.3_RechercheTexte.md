# T3.3 Recherche textuelle
{{ initexo(0) }}

## 1. Recherche naïve et efficacité

!!! gear "Illustration de l'algorithme"
    ![](../images/naive.gif){: .center} 

!!! example "BNS 2024, sujet 21, exercice 1"
    === "Énoncé"
        Écrire une fonction `recherche_motif` qui prend en paramètre une chaîne de caractères
        `motif` non vide et une chaîne de caractères `texte` et qui renvoie la liste des positions de
        `motif` dans `texte`. Si `motif` n’apparaît pas, la fonction renvoie une liste vide.

        Exemples:

        ```python
        >>> recherche_motif("ab", "")
        []
        >>> recherche_motif("ab", "cdcdcdcd")
        []
        >>> recherche_motif("ab", "abracadabra")
        [0, 7]
        >>> recherche_motif("ab", "abracadabraab")
        [0, 7, 11]
        ```
    === "Proposition de correction"
        ```python linenums='1'
        def recherche_motif(motif:str, texte:str) -> list:
            """
            Renvoie une liste, éventuellement vide, des positions de motif dans texte.
            """
            positions = []
            for i in range(len(texte)-len(motif)+1):
                j = 0
                while j < len(motif) and texte[i+j] == motif[j] :
                    j += 1
                if j == len(motif):
                    positions.append(i)
            return positions

        assert recherche_motif("ab", "") == []
        assert recherche_motif("ab", "cdcdcdcd") == []
        assert recherche_motif("ab", "abracadabra") == [0, 7]
        assert recherche_motif("ab", "abracadabraab") == [0, 7, 11]
        ```


!!! example "1 ecicrexe ,12 tejus ,4202 SNB"

    Modifier la fonction précédente pour quelle effectue la recherche «à l'envers», c'est-à-dire en partant de la fin de `motif`.


    !!! gear "Illustration de l'algorithme"
        ![](../images/naive_envers.gif){: .center} 
        <gif-player src="https://cgouygou.github.io/TNSI/T02_Programmation/images/ezgif_pile.gif" speed="1" play></gif-player>


Cette fonction permet de rechercher n'importe quelle chaîne de caractères dans ... n'importe quelle chaîne de caractères. On utilise la plupart du temps (avec souvent le raccourci `CTRL+F`) cette recherche pour chercher un fragment de code (un nom de variable à remplacer par exemple) dans un programme ou bien pour chercher une occurence d'un mot dans une page web. 

Pour mesurer l'efficacité de cet algorithme naïf, nous allons faire une recherche dans le [texte intégral](../data/pg6318.txt) de *L'Avare*, de Molière, mis à disposition légalement par le [Projet Gutenberg](https://www.gutenberg.org/browse/languages/fr){:target="_blank"} .

!!! example "{{ exercice() }}"
    Mesurer le temps d'exécution de la fonction `recherche_motif` sur 3 chaînes de caractères:
    
    - une courte, dont on est sûr.e qu'elle apparaît dans le texte;
    - une (plus) longue, dont on est sûr.e qu'elle apparaît dans le texte (par exemple `'Il faut, pour me donner conseil, que je voie ma cassette.'`);
    - une dernière dont on est sûr.e qu'elle n'apparaît pas dans le texte (par exemple `'Iron Man'`, `'Gouygou'`, `"le gras c'est la vie."`, etc.).

    On peut utiliser pour cela le code suivant (à compléter):

    ```python linenums='1'
    import time

    with open('......') as f:
        piece = f.read().replace('\n', ' ') # pour obtenir une seule chaîne de caractères (certes très longue)

    def chrono(motif, texte):
        t0 = time.time()
        recherche_naive(motif, texte)
        return time.time() - t0

    for m in [...]:
        print(chrono(..., ...))

    ```
        